<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catalogue Bot</title>
    
    <!-- Intégration de Tailwind CSS pour un design rapide et moderne -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Script officiel pour les Mini Apps Telegram -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    
    <style>
        /* Style pour la scrollbar (esthétique) */
        ::-webkit-scrollbar {
            width: 5px;
        }
        ::-webkit-scrollbar-track {
            background: #1a202c; /* bg-gray-800 */
        }
        ::-webkit-scrollbar-thumb {
            background: #4a5568; /* bg-gray-600 */
            border-radius: 10px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #718096; /* bg-gray-500 */
        }
        /* Style pour les flèches des menus déroulants */
        select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%239ca3af' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
    </style>
</head>
<body class="bg-gray-900 text-white font-sans antialiased">

    <div id="app" class="container mx-auto max-w-lg p-4">

        <!-- Section du logo -->
        <header class="flex justify-center py-4">
            <img src="https://placehold.co/100x100/1a202c/FFFF00?text=Logo" alt="Logo du Bot" class="w-24 h-24 rounded-full border-2 border-yellow-400 shadow-lg">
        </header>

        <!-- Section des filtres (menus déroulants) -->
        <div class="filters flex justify-between gap-4 my-6">
            <select id="category-filter" class="w-1/2 bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-yellow-400">
                <option value="all">Toutes les catégories</option>
                <option value="fleurs">Fleurs</option>
                <option value="resines">Résines</option>
                <option value="huiles">Huiles</option>
            </select>
            <select id="farm-filter" class="w-1/2 bg-gray-700 border border-gray-600 rounded-lg p-3 text-white focus:outline-none focus:ring-2 focus:ring-yellow-400">
                <option value="all">Toutes les farms</option>
                <option value="nektar">Nektar Farm</option>
                <option value="green">Green Farm</option>
                <option value="bio">Bio Farm</option>
            </select>
        </div>

        <!-- Grille des produits -->
        <main id="product-grid" class="grid grid-cols-2 gap-4">
            <!-- Les produits seront injectés ici par JavaScript -->
        </main>

    </div>

    <script>
        // --- DONNÉES DE DÉMONSTRATION ---
        // Dans une vraie application, ces données viendraient d'une base de données (API)
        const products = [
            { id: 1, name: 'Nek Breaker', category: 'fleurs', farm: 'nektar', imageUrl: 'https://placehold.co/400x400/333/fff?text=Nek+Breaker' },
            { id: 2, name: 'Brain Juice', category: 'huiles', farm: 'nektar', imageUrl: 'https://placehold.co/400x400/333/fff?text=Brain+Juice' },
            { id: 3, name: 'Green Power', category: 'fleurs', farm: 'green', imageUrl: 'https://placehold.co/400x400/333/fff?text=Green+Power' },
            { id: 4, name: 'Bio Hash', category: 'resines', farm: 'bio', imageUrl: 'https://placehold.co/400x400/333/fff?text=Bio+Hash' },
            { id: 5, name: 'Golden Oil', category: 'huiles', farm: 'green', imageUrl: 'https://placehold.co/400x400/333/fff?text=Golden+Oil' },
            { id: 6, name: 'Sweet Flower', category: 'fleurs', farm: 'bio', imageUrl: 'https://placehold.co/400x400/333/fff?text=Sweet+Flower' },
            { id: 7, name: 'Dark Resin', category: 'resines', farm: 'nektar', imageUrl: 'https://placehold.co/400x400/333/fff?text=Dark+Resin' },
        ];

        // --- ÉLÉMENTS DU DOM ---
        const productGrid = document.getElementById('product-grid');
        const categoryFilter = document.getElementById('category-filter');
        const farmFilter = document.getElementById('farm-filter');

        // --- FONCTIONS ---

        /**
         * Affiche les produits dans la grille
         * @param {Array} productsToDisplay - Le tableau de produits à afficher
         */
        function renderProducts(productsToDisplay) {
            // On vide la grille avant de la remplir
            productGrid.innerHTML = '';

            if (productsToDisplay.length === 0) {
                productGrid.innerHTML = `<p class="col-span-2 text-center text-gray-400 mt-8">Aucun produit ne correspond à votre recherche.</p>`;
                return;
            }

            // On crée une carte pour chaque produit
            productsToDisplay.forEach(product => {
                const productCard = `
                    <div class="product-card bg-gray-800 rounded-lg overflow-hidden shadow-lg transform hover:scale-105 transition-transform duration-300 cursor-pointer">
                        <img src="${product.imageUrl}" alt="${product.name}" class="w-full h-40 object-cover">
                        <div class="p-4">
                            <h3 class="font-bold text-lg flex items-center gap-2">
                                <!-- Icônes SVG pour l'exemple -->
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-pink-400"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline></svg>
                                ${product.name}
                            </h3>
                            <p class="text-sm text-gray-400 mt-1">
                                ${product.farm.charAt(0).toUpperCase() + product.farm.slice(1).replace(' farm', ' Farm')}
                            </p>
                        </div>
                    </div>
                `;
                productGrid.innerHTML += productCard;
            });
        }

        /**
         * Filtre les produits en fonction des sélections et les affiche
         */
        function filterAndRender() {
            const selectedCategory = categoryFilter.value;
            const selectedFarm = farmFilter.value;

            const filteredProducts = products.filter(product => {
                const categoryMatch = selectedCategory === 'all' || product.category === selectedCategory;
                const farmMatch = selectedFarm === 'all' || product.farm === selectedFarm;
                return categoryMatch && farmMatch;
            });

            renderProducts(filteredProducts);
        }

        // --- ÉVÉNEMENTS & INITIALISATION ---

        // On écoute les changements sur les filtres
        categoryFilter.addEventListener('change', filterAndRender);
        farmFilter.addEventListener('change', filterAndRender);
        
        // Initialisation de l'application Telegram
        try {
            const tg = window.Telegram.WebApp;
            // Informe le client Telegram que l'application est prête
            tg.ready(); 
            // Change la couleur de fond pour correspondre au thème
            tg.setHeaderColor('#1a202c');
            tg.setBackgroundColor('#1a202c');
        } catch (e) {
            console.error("L'API Telegram Web App n'est pas disponible.", e);
        }


        // Affichage initial de tous les produits au chargement de la page
        renderProducts(products);

    </script>

</body>
</html>
